rule installer_coronavirus {

   meta:
   
      description = "Rule to detect the Corona Virus Installer"
      author = "Marc Rivero | McAfee ATR Team"
      hash1 = "5987a6e42c3412086b7c9067dc25f1aaa659b2b123581899e9df92cb7907a3ed"

   strings:

      $s1 = { 61 63 68 65 6c 6c 69 65 73 40 68 6f 74 6d 61 69 6c 2e 63 6f 6d }
      $s2 = {74 6f 6a 65 6e 2e 6d 65 40 67 6d 61 69 6c 2e 63 6f 6d}
      $s4 = {77 61 6e 67 63 68 79 7a 40 67 6d 61 69 6c 2e 63 6f 6d}
      $s5 = {54006f0064006f00730020006c006f00730020007400690070006f007300200064006500200069006d006100670065006e007c002a002e0062006d0070003b002a002e006300750072003b002a002e006400690062003b002a002e0065006d0066003b002a002e00690063006f003b002a002e0077006d0066007c004d00610070006100730020006400650020006200690074007300200028002a002e0062006d0070003b002a002e0064006900620029007c002a002e0062006d0070003b002a002e006400690062007c00490063006f006e006f0073002f0063007500720073006f00720065007300200028002a002e00690063006f003b002a002e0063007500720029007c002a002e00690063006f003b002a002e006300750072007c004d006500740061006100720063006800690076006f007300200028002a002e0077006d0066003b002a002e0065006d00660029007c002a002e0077006d0066003b002a002e0065006d0066007c0054006f0064006f00730020006c006f00730020006100720063006800690076006f007300200028002a002e002a0029007c002a002e002a007c007c00}
      $s6 = {480054004d004c005f0049004d00470023004900440052005f00480054004d005f0049004d0041004700450053005f004c0049005f00430041005000540049004f004e005f0048004f005600450052005f0050004e00470029004900440052005f00480054004d005f0049004d0041004700450053005f00530042005f0048005f005300430052004f004c004c005f0050005200450056005f0048004f005600450052005f0050004e00470031004900440052005f00480054004d005f0049004d0047005f0050004100470045005f005400490054004c0045005f00490043004f004e005f004d0045004e0055005f004f00520041004e00470045005f0043004c004f00530045005f0050004e00470032004900440052005f00480054004d005f0049004d0047005f0050004100470045005f005400490054004c0045005f00490043004f004e005f004d0045004e0055005f0050004100490044005f00530045005400540049004e00470053005f0050004e004700}
      $s7 = {25735c6c6f675f2530346425303264253032645f25642e6c6f67}

   condition:

      uint16(0) == 0x5a4d and filesize < 3000KB and all of them
}

rule ransomware_coronavirus {

   meta:
   
      description = "Rule to detect the Corona Virus ransomware"
      author = "Marc Rivero | McAfee ATR Team"
      hash1 = "3299f07bc0711b3587fe8a1c6bf3ee6bcbc14cb775f64b28a61d72ebcb8968d3"
   
   strings:

      $s1 = {25732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573257325732573}
      $s2 = {2500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300250073002500730025007300}
      $s3 = {2f00750070006c006f00610064002f00250073005f00250064005f0025007300}
      $s4 = {53595354454d5c43757272656e74436f6e74726f6c5365745c436f6e74726f6c5c53657373696f6e204d616e61676572}
      $s5 = {5c5c2e5c506879736963616c44726976652564}
         
   condition:

      uint16(0) == 0x5a4d and filesize < 100KB and all of them
}
